# -*- mode: shell-script; sh-shell: zsh; fill-column: 75; comment-column: 50; coding: utf-8 -*-

emulate -L zsh

local expr
local PROMPT4 PS4="; "

if [[ "$*" =~ "^[oO]?[t0-9a-fA-Fx.]+[oO]?$" ]]; then
    { setopt xtrace; rax2 $* }
else
    expr="$(print $* | perl -wple '1 while s/([a-z]+) (.*)$/$1($2)/g')"
    { setopt xtrace; emacsclient -e "(calc-eval \"$expr\")" } | perl -wple 's/^"|"$//g'
fi
